<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Chapter 4 – Automated Incident Response | AI enabled blue team operations for small to medium size businesses</title>
<meta name="keywords" content="">
<meta name="description" content="Chapter 4 – Automated Incident Response
4.1 The Incident‑Response Lifecycle

Detection – Alerts from the AI‑driven threat‑detection pipeline.
Triage – Automated scoring and enrichment to prioritize incidents.
Containment – Automated actions (e.g., blocking IPs, disabling accounts) via playbooks.
Eradication – Removal of malware, patching, or re‑image of compromised hosts.
Recovery – Restoring services and validating integrity.
Lessons Learned – Post‑mortem analysis and knowledge base updates.

4.2 Playbook Generation with Stable‑Baselines3

Reinforcement Learning (RL) – Train an RL agent to decide the best action given an incident state.
State Representation – Combine alert metadata, IOC context, and system telemetry into a vector.
Action Space – Block IP, quarantine host, run script, or request analyst review.
Reward Function – Minimize time to containment and false positives.
Deployment – The trained policy is exposed via a REST endpoint; playbooks are generated on‑demand.

4.3 Integration with Wazuh

Rule Engine – Wazuh’s rule engine can trigger custom scripts when a specific alert type is detected.
Active Response – Wazuh can automatically execute commands (e.g., iptables -A INPUT -s &lt;ip&gt; -j DROP).
Correlation – Wazuh alerts are forwarded to Elastic SIEM for correlation and enrichment.
Feedback Loop – Wazuh’s event logs are fed back into the RL training pipeline to improve future playbooks.

4.4 OpenCTI for Threat Context

Actor &amp; Malware Mapping – OpenCTI provides detailed TTPs for known threat actors.
Automated Playbook Augmentation – The RL agent can query OpenCTI to add context‑specific actions (e.g., block known malicious domains).
Data Sharing – Playbooks can push new IOCs back into OpenCTI for community sharing.

4.5 Orchestration Layer

SOAR‑like Workflow – A lightweight orchestrator (e.g., a Python Flask app) coordinates between Elastic SIEM, Wazuh, and the RL playbook service.
Webhook Endpoints – Elastic SIEM posts alerts to the orchestrator; the orchestrator calls the RL service and then triggers Wazuh active responses.
Audit Trail – All actions are logged in a PostgreSQL database for compliance and forensic analysis.

4.6 Continuous Improvement

Model Retraining – After each incident, the RL agent’s experience replay buffer is updated with real outcomes.
Human‑in‑the‑Loop – Analysts can override or approve playbooks; the decisions are recorded and used for supervised fine‑tuning.
Metrics – Track mean time to containment (MTTC), false‑positive rate, and analyst effort reduction.


This chapter shows how to turn detection into action by combining reinforcement learning, Wazuh’s active‑response capabilities, and OpenCTI’s threat context into an automated, continuously improving incident‑response workflow.">
<meta name="author" content="delphijc">
<link rel="canonical" href="//localhost:1313/chapter4/">
<link crossorigin="anonymous" href="../assets/css/stylesheet.f6853c0d9335d13ee38ea4c37958cedb9b4b080fce2060db60440b49c0cf1e1d.css" integrity="sha256-9oU8DZM10T7jjqTDeVjO25tLCA/OIGDbYEQLScDPHh0=" rel="preload stylesheet" as="style">
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="//localhost:1313/chapter4/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/" accesskey="h" title="AI enabled blue team operations for small to medium size businesses (Alt + H)">AI enabled blue team operations for small to medium size businesses</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter1/" title="Chapter 1">
                    <span>Chapter 1</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter2/" title="Chapter 2">
                    <span>Chapter 2</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter3/" title="Chapter 3">
                    <span>Chapter 3</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter4/" title="Chapter 4">
                    <span class="active">Chapter 4</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter5/" title="Chapter 5">
                    <span>Chapter 5</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter6/" title="Chapter 6">
                    <span>Chapter 6</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter7/" title="Chapter 7">
                    <span>Chapter 7</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter8/" title="Chapter 8">
                    <span>Chapter 8</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter9/" title="Chapter 9">
                    <span>Chapter 9</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/chapter10/" title="Chapter 10">
                    <span>Chapter 10</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Chapter 4 – Automated Incident Response
    </h1>
    <div class="post-meta"><span title='2025-11-28 00:00:00 +0000 UTC'>November 28, 2025</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>delphijc</span>

</div>
  </header> 
  <div class="post-content"><h1 id="chapter4--automated-incident-response">Chapter 4 – Automated Incident Response<a hidden class="anchor" aria-hidden="true" href="#chapter4--automated-incident-response">#</a></h1>
<h2 id="41-the-incidentresponse-lifecycle">4.1 The Incident‑Response Lifecycle<a hidden class="anchor" aria-hidden="true" href="#41-the-incidentresponse-lifecycle">#</a></h2>
<ol>
<li><strong>Detection</strong> – Alerts from the AI‑driven threat‑detection pipeline.</li>
<li><strong>Triage</strong> – Automated scoring and enrichment to prioritize incidents.</li>
<li><strong>Containment</strong> – Automated actions (e.g., blocking IPs, disabling accounts) via playbooks.</li>
<li><strong>Eradication</strong> – Removal of malware, patching, or re‑image of compromised hosts.</li>
<li><strong>Recovery</strong> – Restoring services and validating integrity.</li>
<li><strong>Lessons Learned</strong> – Post‑mortem analysis and knowledge base updates.</li>
</ol>
<h2 id="42-playbook-generation-with-stablebaselines3">4.2 Playbook Generation with Stable‑Baselines3<a hidden class="anchor" aria-hidden="true" href="#42-playbook-generation-with-stablebaselines3">#</a></h2>
<ul>
<li><strong>Reinforcement Learning (RL)</strong> – Train an RL agent to decide the best action given an incident state.</li>
<li><strong>State Representation</strong> – Combine alert metadata, IOC context, and system telemetry into a vector.</li>
<li><strong>Action Space</strong> – Block IP, quarantine host, run script, or request analyst review.</li>
<li><strong>Reward Function</strong> – Minimize time to containment and false positives.</li>
<li><strong>Deployment</strong> – The trained policy is exposed via a REST endpoint; playbooks are generated on‑demand.</li>
</ul>
<h2 id="43-integration-with-wazuh">4.3 Integration with Wazuh<a hidden class="anchor" aria-hidden="true" href="#43-integration-with-wazuh">#</a></h2>
<ul>
<li><strong>Rule Engine</strong> – Wazuh’s rule engine can trigger custom scripts when a specific alert type is detected.</li>
<li><strong>Active Response</strong> – Wazuh can automatically execute commands (e.g., <code>iptables -A INPUT -s &lt;ip&gt; -j DROP</code>).</li>
<li><strong>Correlation</strong> – Wazuh alerts are forwarded to Elastic SIEM for correlation and enrichment.</li>
<li><strong>Feedback Loop</strong> – Wazuh’s event logs are fed back into the RL training pipeline to improve future playbooks.</li>
</ul>
<h2 id="44-opencti-for-threat-context">4.4 OpenCTI for Threat Context<a hidden class="anchor" aria-hidden="true" href="#44-opencti-for-threat-context">#</a></h2>
<ul>
<li><strong>Actor &amp; Malware Mapping</strong> – OpenCTI provides detailed TTPs for known threat actors.</li>
<li><strong>Automated Playbook Augmentation</strong> – The RL agent can query OpenCTI to add context‑specific actions (e.g., block known malicious domains).</li>
<li><strong>Data Sharing</strong> – Playbooks can push new IOCs back into OpenCTI for community sharing.</li>
</ul>
<h2 id="45-orchestration-layer">4.5 Orchestration Layer<a hidden class="anchor" aria-hidden="true" href="#45-orchestration-layer">#</a></h2>
<ul>
<li><strong>SOAR‑like Workflow</strong> – A lightweight orchestrator (e.g., a Python Flask app) coordinates between Elastic SIEM, Wazuh, and the RL playbook service.</li>
<li><strong>Webhook Endpoints</strong> – Elastic SIEM posts alerts to the orchestrator; the orchestrator calls the RL service and then triggers Wazuh active responses.</li>
<li><strong>Audit Trail</strong> – All actions are logged in a PostgreSQL database for compliance and forensic analysis.</li>
</ul>
<h2 id="46-continuous-improvement">4.6 Continuous Improvement<a hidden class="anchor" aria-hidden="true" href="#46-continuous-improvement">#</a></h2>
<ul>
<li><strong>Model Retraining</strong> – After each incident, the RL agent’s experience replay buffer is updated with real outcomes.</li>
<li><strong>Human‑in‑the‑Loop</strong> – Analysts can override or approve playbooks; the decisions are recorded and used for supervised fine‑tuning.</li>
<li><strong>Metrics</strong> – Track mean time to containment (MTTC), false‑positive rate, and analyst effort reduction.</li>
</ul>
<hr>
<p><em>This chapter shows how to turn detection into action by combining reinforcement learning, Wazuh’s active‑response capabilities, and OpenCTI’s threat context into an automated, continuously improving incident‑response workflow.</em></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="//localhost:1313/">AI enabled blue team operations for small to medium size businesses</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
