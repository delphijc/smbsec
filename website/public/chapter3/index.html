<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Chapter 3 – AI‑Driven Threat Detection | AI enabled blue team operations for small to medium size businesses</title>
<meta name="keywords" content="">
<meta name="description" content="Chapter 3 – AI‑Driven Threat Detection
3.1 The Threat‑Detection Pipeline

Data Collection – Logs, network flows, endpoint telemetry, and threat‑intel feeds are ingested into a central store (Elasticsearch, PostgreSQL, or a vector database).
Pre‑processing &amp; Normalization – Structured logs are parsed, timestamps aligned, and categorical fields encoded.
Feature Extraction – Textual fields (e.g., error messages, command lines) are embedded with Sentence‑Transformers; numeric fields are scaled.
Model Scoring – A trained model (e.g., an autoencoder or a fine‑tuned LLM) assigns a risk score to each event.
Enrichment – Scores are cross‑checked against known indicators of compromise (IOCs) from OpenCTI and enriched with threat‑intel feeds.
Alert Generation – High‑score events trigger alerts in Elastic SIEM or a custom dashboard.
Feedback Loop – Analysts label alerts; the labels feed back into the model for continual improvement.

3.2 Log Analysis with LLMs

Log Summarization – Llama‑2 can condense long log entries into concise, human‑readable summaries.
Pattern Extraction – The model can identify recurring malicious patterns (e.g., credential dumping, lateral movement) and suggest new IOC patterns.
Zero‑Shot Classification – Using prompt engineering, the LLM can classify logs into categories (malicious, benign, suspicious) without explicit training data.

3.3 IOC Enrichment via OpenCTI

STIX/TAXII Integration – OpenCTI exposes a REST/TAXII API that can be queried for the latest threat actors, malware, and vulnerability data.
Automated Matching – A lightweight Python script pulls new IOCs from OpenCTI, stores them in a vector index (FAISS), and performs similarity search against incoming logs.
Contextualization – Each alert can be annotated with the actor’s TTPs, known malware families, and historical campaign data.

3.4 Anomaly Detection with FAISS &amp; Sentence‑Transformers

Embedding Generation – Logs are converted to dense vectors using Sentence‑Transformers.
Indexing – FAISS builds an approximate nearest‑neighbor index for millions of vectors.
Distance Thresholding – Events that fall outside a defined similarity radius are flagged as anomalies.
Explainability – The nearest neighbors are displayed to analysts, providing context for why an event is anomalous.

3.5 Elastic SIEM as the Alert Hub

Alert Correlation – Elastic SIEM aggregates alerts from multiple sources and correlates them using machine‑learning‑based correlation rules.
Dashboards – Kibana dashboards provide real‑time visibility into threat‑detection metrics (alert volume, false‑positive rate, detection latency).
Playbook Integration – Alerts can trigger automated playbooks (e.g., Wazuh rules, SOAR actions) for rapid response.

3.6 Continuous Improvement

Model Retraining – Periodically retrain models on newly labeled data to adapt to evolving attack patterns.
Feedback Channels – Analysts can provide feedback via a simple web form; the data is fed back into the training pipeline.
Metrics – Track precision, recall, and mean time to detect (MTTD) to measure the effectiveness of the AI‑driven pipeline.


This chapter demonstrates how to combine open‑source AI tools—OpenCTI, Elastic SIEM, FAISS, Sentence‑Transformers, and Llama‑2—to build a robust, automated threat‑detection system that scales with a small security team.">
<meta name="author" content="delphijc">
<link rel="canonical" href="http://localhost:1313/chapter3/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/chapter3/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="AI enabled blue team operations for small to medium size businesses (Alt + H)">AI enabled blue team operations for small to medium size businesses</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter1/" title="Chapter 1">
                    <span>Chapter 1</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter2/" title="Chapter 2">
                    <span>Chapter 2</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter3/" title="Chapter 3">
                    <span class="active">Chapter 3</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter4/" title="Chapter 4">
                    <span>Chapter 4</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter5/" title="Chapter 5">
                    <span>Chapter 5</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter6/" title="Chapter 6">
                    <span>Chapter 6</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter7/" title="Chapter 7">
                    <span>Chapter 7</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter8/" title="Chapter 8">
                    <span>Chapter 8</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter9/" title="Chapter 9">
                    <span>Chapter 9</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/chapter10/" title="Chapter 10">
                    <span>Chapter 10</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Chapter 3 – AI‑Driven Threat Detection
    </h1>
    <div class="post-meta"><span title='2025-11-28 00:00:00 +0000 UTC'>November 28, 2025</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>delphijc</span>

</div>
  </header> 
  <div class="post-content"><h1 id="chapter3--aidriven-threat-detection">Chapter 3 – AI‑Driven Threat Detection<a hidden class="anchor" aria-hidden="true" href="#chapter3--aidriven-threat-detection">#</a></h1>
<h2 id="31-the-threatdetection-pipeline">3.1 The Threat‑Detection Pipeline<a hidden class="anchor" aria-hidden="true" href="#31-the-threatdetection-pipeline">#</a></h2>
<ol>
<li><strong>Data Collection</strong> – Logs, network flows, endpoint telemetry, and threat‑intel feeds are ingested into a central store (Elasticsearch, PostgreSQL, or a vector database).</li>
<li><strong>Pre‑processing &amp; Normalization</strong> – Structured logs are parsed, timestamps aligned, and categorical fields encoded.</li>
<li><strong>Feature Extraction</strong> – Textual fields (e.g., error messages, command lines) are embedded with <strong>Sentence‑Transformers</strong>; numeric fields are scaled.</li>
<li><strong>Model Scoring</strong> – A trained model (e.g., an autoencoder or a fine‑tuned LLM) assigns a risk score to each event.</li>
<li><strong>Enrichment</strong> – Scores are cross‑checked against known indicators of compromise (IOCs) from <strong>OpenCTI</strong> and enriched with threat‑intel feeds.</li>
<li><strong>Alert Generation</strong> – High‑score events trigger alerts in <strong>Elastic SIEM</strong> or a custom dashboard.</li>
<li><strong>Feedback Loop</strong> – Analysts label alerts; the labels feed back into the model for continual improvement.</li>
</ol>
<h2 id="32-log-analysis-with-llms">3.2 Log Analysis with LLMs<a hidden class="anchor" aria-hidden="true" href="#32-log-analysis-with-llms">#</a></h2>
<ul>
<li><strong>Log Summarization</strong> – Llama‑2 can condense long log entries into concise, human‑readable summaries.</li>
<li><strong>Pattern Extraction</strong> – The model can identify recurring malicious patterns (e.g., credential dumping, lateral movement) and suggest new IOC patterns.</li>
<li><strong>Zero‑Shot Classification</strong> – Using prompt engineering, the LLM can classify logs into categories (malicious, benign, suspicious) without explicit training data.</li>
</ul>
<h2 id="33-ioc-enrichment-via-opencti">3.3 IOC Enrichment via OpenCTI<a hidden class="anchor" aria-hidden="true" href="#33-ioc-enrichment-via-opencti">#</a></h2>
<ul>
<li><strong>STIX/TAXII Integration</strong> – OpenCTI exposes a REST/TAXII API that can be queried for the latest threat actors, malware, and vulnerability data.</li>
<li><strong>Automated Matching</strong> – A lightweight Python script pulls new IOCs from OpenCTI, stores them in a vector index (FAISS), and performs similarity search against incoming logs.</li>
<li><strong>Contextualization</strong> – Each alert can be annotated with the actor’s TTPs, known malware families, and historical campaign data.</li>
</ul>
<h2 id="34-anomaly-detection-with-faiss--sentencetransformers">3.4 Anomaly Detection with FAISS &amp; Sentence‑Transformers<a hidden class="anchor" aria-hidden="true" href="#34-anomaly-detection-with-faiss--sentencetransformers">#</a></h2>
<ul>
<li><strong>Embedding Generation</strong> – Logs are converted to dense vectors using Sentence‑Transformers.</li>
<li><strong>Indexing</strong> – FAISS builds an approximate nearest‑neighbor index for millions of vectors.</li>
<li><strong>Distance Thresholding</strong> – Events that fall outside a defined similarity radius are flagged as anomalies.</li>
<li><strong>Explainability</strong> – The nearest neighbors are displayed to analysts, providing context for why an event is anomalous.</li>
</ul>
<h2 id="35-elastic-siem-as-the-alert-hub">3.5 Elastic SIEM as the Alert Hub<a hidden class="anchor" aria-hidden="true" href="#35-elastic-siem-as-the-alert-hub">#</a></h2>
<ul>
<li><strong>Alert Correlation</strong> – Elastic SIEM aggregates alerts from multiple sources and correlates them using machine‑learning‑based correlation rules.</li>
<li><strong>Dashboards</strong> – Kibana dashboards provide real‑time visibility into threat‑detection metrics (alert volume, false‑positive rate, detection latency).</li>
<li><strong>Playbook Integration</strong> – Alerts can trigger automated playbooks (e.g., Wazuh rules, SOAR actions) for rapid response.</li>
</ul>
<h2 id="36-continuous-improvement">3.6 Continuous Improvement<a hidden class="anchor" aria-hidden="true" href="#36-continuous-improvement">#</a></h2>
<ul>
<li><strong>Model Retraining</strong> – Periodically retrain models on newly labeled data to adapt to evolving attack patterns.</li>
<li><strong>Feedback Channels</strong> – Analysts can provide feedback via a simple web form; the data is fed back into the training pipeline.</li>
<li><strong>Metrics</strong> – Track precision, recall, and mean time to detect (MTTD) to measure the effectiveness of the AI‑driven pipeline.</li>
</ul>
<hr>
<p><em>This chapter demonstrates how to combine open‑source AI tools—OpenCTI, Elastic SIEM, FAISS, Sentence‑Transformers, and Llama‑2—to build a robust, automated threat‑detection system that scales with a small security team.</em></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">AI enabled blue team operations for small to medium size businesses</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
